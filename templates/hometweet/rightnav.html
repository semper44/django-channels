{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>
    <div class="h-full mt-7 pt-2 ">
        <div class="w-full flex justify-center">                  
            <form method="get" class="relative" id="rightnavsearchform">
                <input type="text" 
                placeholder="Search"
                name="query"
                data-content="search"
                id="rightnavsearchButton"
                class="active text-[#0d2438] dark:text-gray-300 bg-transparent border-2 bg-0 outline-none border-[#0d2438] dark:border-gray-300 rounded-xl pl-3 h-[28px] ">
                <div id="rightnavsearchicon" class="absolute w-fit top-0 right-2" style="top: 2px;">
                    <i  class="fa fa-search text-[#0d2438] dark:text-white cursor-pointer" aria-hidden="true"></i>
                </div>               
            </form>            
        </div>

        <div id="allrightnavsuggestions" class="w-full mt-4" style="margin-top: 3rem;">
            <p class="text-[#0d2438] dark:text-white text-center my-8">Suggestions</p>
            <div  class="w-full flex flex-col justify-center items-center">                                
                <div id="suggestions" class="w-full flex flex-col justify-center items-center gap-4">                                
                </div>
            </div>

            <a href="{% url 'find_friends_templates' %}" class="w-full flex justify-center items-center mt-2">
                <p class="w-3/4 text-[#0d2438] dark:text-white mt-4 text-center border border-green-600 hover:bg-green-600 hover:text-white py-2 rounded-xl">See all </p>
            </a>
        </div>

        <div id="rightnavParent" class="hidden w-full">
            <div id="rightnavcancel" class="w-full flex justify-end mt-3  pr-2 cursor-pointer">
                <i  class="fa-solid fa-xmark text-red-600"></i>
            </div>
            <div id="rightnavsearch" class="w-full mt-4 hidden text-center text-[#0d2438] dark:text-gray-300">
            Searching...
            </div>
            <div id="rightnavsearch2" class="w-full mt-4 text-center text-[#0d2438] dark:text-gray-300 flex flex-col justify-center items-center gap-4">
                hyfhdjdj
            </div>
        </div>

    </div>

<script >
document.addEventListener("DOMContentLoaded",(function(){let rightnavsearchButton=document.querySelector("#rightnavsearchButton");let rightnavsearchicon=document.querySelector("#rightnavsearchicon");let rightnavsearch=document.querySelector("#rightnavsearch");let rightnavsearch2=document.querySelector("#rightnavsearch2");let rightnavParent=document.querySelector("#rightnavParent");rightnavsearchButton.addEventListener("input",(()=>{document.querySelector("#allrightnavsuggestions").style.display="none";rightnavParent.style.display="block";rightnavsearch.style.display="block";rightnavsearch2.style.display="none"}));document.querySelector("#rightnavcancel").addEventListener("click",(()=>{rightnavParent.style.display="none";console.log(document.querySelector("#rightnavParent"));document.querySelector("#allrightnavsuggestions").style.display="block"}));rightnavsearchicon.onclick=async e=>{document.querySelector("#allrightnavsuggestions").style.display="none";rightnavParent.style.display="block";e.preventDefault();const formData=new FormData(document.querySelector("#rightnavsearchform"));const searchParams=new URLSearchParams(formData);const url='{% url "search" %}'+"?"+searchParams.toString();const response=await fetch(url,{method:"GET",headers:{"X-CSRFToken":"{{ csrf_token }}"}});if(response.ok){const data=await response.json();document.querySelector("#rightnavParent").style.display="block";rightnavsearch2.style.display="flex";if(data.results.length>=1){data.results.forEach((item=>{let parentdiv=document.createElement("div");let buttonparentdiv=document.createElement("div");let namesparentdiv=document.createElement("div");let imageparentdiv=document.createElement("div");let profPics=document.createElement("img");let username=document.createElement("p");let bio=document.createElement("p");let viewProfile=document.createElement("p");let addfriend=document.createElement("p");parentdiv.style.width="80%";parentdiv.style.padding="1.5rem 0";parentdiv.style.height="fit-content";parentdiv.style.position="relative";parentdiv.style.backgroundImage="url("+item.cover+")";parentdiv.style.borderRadius="10px";parentdiv.style.minHeight="108px";profPics.src=item.pics;profPics.style.width="60px";profPics.style.height="60px";profPics.style.borderRadius="50%";profPics.style.position="absolute";profPics.style.left="4%";profPics.style.zIndex="20";parentdiv.append(profPics);username.innerHTML=item.username;username.style.color="white";username.style.width="100%";username.style.textAlign="center";bio.innerHTML="item.bio";bio.style.color="white";bio.style.width="100%";bio.style.textAlign="center";viewProfile.style.height="fit-content";viewProfile.style.width="fit-content";viewProfile.style.padding="5px";viewProfile.style.color="white";viewProfile.style.borderRadius="5px";viewProfile.style.backgroundColor="limegreen";viewProfile.style.zIndex="20";viewProfile.style.marginTop="8px";viewProfile.style.cursor="pointer";viewProfile.innerHTML="View";namesparentdiv.style.display="grid";namesparentdiv.style.backgroundColor="black";namesparentdiv.style.opacity="0.4";namesparentdiv.style.backdropFilter="blur(2px)";namesparentdiv.style.position="absolute";namesparentdiv.style.bottom="0";namesparentdiv.style.width="100%";namesparentdiv.style.height="50%";namesparentdiv.style.borderRadius="5px";namesparentdiv.style.paddingBottom="3x";namesparentdiv.append(username);namesparentdiv.append(bio);buttonparentdiv.append(addfriend);buttonparentdiv.append(viewProfile);buttonparentdiv.style.position="absolute";buttonparentdiv.style.right="4%";buttonparentdiv.style.top="6%";buttonparentdiv.style.zIndex="10";parentdiv.append(buttonparentdiv);parentdiv.append(namesparentdiv);rightnavsearch2.append(parentdiv)}))}else{document.querySelector("#rightnavcancel").style.display="block";rightnavsearch.style.display="none";rightnavsearch2.innerHTML="Search not found"}}else{}};let typingTimer;rightnavsearchButton.addEventListener("input",(e=>{clearTimeout(typingTimer);typingTimer=setTimeout((async()=>{document.querySelector("#allrightnavsuggestions").style.display="none";e.preventDefault();const formData=new FormData(document.querySelector("#rightnavsearchform"));const searchParams=new URLSearchParams(formData);const url='{% url "search" %}'+"?"+searchParams.toString();const response=await fetch(url,{method:"GET",headers:{"X-CSRFToken":"{{ csrf_token }}"}});const data=await response.json();rightnavsearch.style.display="none";rightnavParent.style.display="block";rightnavsearch2.innerHTML="";rightnavsearch2.style.display="flex";if(data.results.length>=1){data.results.slice(0,3).forEach((item=>{let parentdiv=document.createElement("div");let buttonparentdiv=document.createElement("div");let namesparentdiv=document.createElement("div");let imageparentdiv=document.createElement("div");let profPics=document.createElement("img");let username=document.createElement("p");let bio=document.createElement("p");let viewProfile=document.createElement("p");let addfriend=document.createElement("p");parentdiv.style.width="80%";parentdiv.style.padding="1.5rem 0";parentdiv.style.height="fit-content";parentdiv.style.position="relative";parentdiv.style.borderRadius="10px";parentdiv.style.minHeight="108px";profPics.style.width="60px";profPics.style.height="60px";profPics.style.borderRadius="50%";profPics.style.position="absolute";profPics.style.left="4%";profPics.style.zIndex="20";username.style.color="limegreen";username.style.width="100%";username.style.textAlign="center";bio.style.color="white";bio.style.width="100%";bio.style.textAlign="center";viewProfile.style.height="fit-content";viewProfile.style.width="fit-content";viewProfile.style.padding="5px";viewProfile.style.color="white";viewProfile.style.borderRadius="5px";viewProfile.style.backgroundColor="limegreen";viewProfile.style.zIndex="20";viewProfile.style.marginTop="8px";viewProfile.style.cursor="pointer";viewProfile.innerHTML="View";namesparentdiv.style.display="grid";namesparentdiv.style.backgroundColor="black";namesparentdiv.style.opacity="0.4";namesparentdiv.style.backdropFilter="blur(2px)";namesparentdiv.style.position="absolute";namesparentdiv.style.bottom="0";namesparentdiv.style.width="100%";namesparentdiv.style.height="50%";namesparentdiv.style.borderRadius="5px";namesparentdiv.style.paddingBottom="3x";parentdiv.style.background="white";if(item.prof_pics&&item.username){bio.innerHTML=item.bio;username.innerHTML=item.username;profPics.src=item.prof_pics;parentdiv.append(profPics);viewProfile.onclick=function(){window.location.href=`${data.URL_KEY}/profile/${item.username} `}}else if(item.prof_pics&&item.owner){username.innerHTML=item.content;viewProfile.onclick=function(){window.location.href=`${data.URL_KEY}/comments/${item.slug} `}}else{profPics.src=item.pics;username.innerHTML=item.name;bio.innerHTML=item.description;profPics.src=item.photo;parentdiv.append(profPics);viewProfile.onclick=function(){window.location.href=`${data.URL_KEY}/group-view/${item.name} `}}namesparentdiv.append(username);namesparentdiv.append(bio);buttonparentdiv.append(viewProfile);buttonparentdiv.style.position="absolute";buttonparentdiv.style.right="4%";buttonparentdiv.style.top="6%";buttonparentdiv.style.zIndex="10";parentdiv.append(buttonparentdiv);parentdiv.append(namesparentdiv);rightnavsearch2.append(parentdiv)}));let seeAll=document.createElement("p");seeAll.innerHTML="See all";seeAll.style.width="75%";seeAll.style.backgroundColor="white";seeAll.style.color="#0d2438";seeAll.style.textAlign="center";seeAll.style.cursor="pointer";seeAll.style.border="1px solid #00cc66";seeAll.style.padding="0.5rem 0";seeAll.style.borderRadius="10px";seeAll.style.color="#0d2438";rightnavsearch2.append(seeAll);seeAll.addEventListener("mouseenter",(function(){seeAll.style.backgroundColor="#16a34a";seeAll.style.color="white"}));seeAll.addEventListener("mouseleave",(function(){seeAll.style.backgroundColor="white";seeAll.style.color="#0d2438"}));seeAll.addEventListener("click",(async e=>{const url='{% url "search" %}'+"?"+searchParams.toString();window.location.href='{% url "search_view_template" %}'+"?"+searchParams.toString()}))}else{rightnavsearch.style.display="none";rightnavsearch2.innerHTML="Search not found"}}))}))}));
</script>
</body>
</html>