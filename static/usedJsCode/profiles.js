let e="django-channels-byf5.onrender.com";document.querySelectorAll(".profiletrash").forEach((t=>{t.addEventListener("click",(async n=>{const o=t.children[0].getAttribute("data-postdeleteid");if(o===n.target.parentElement.getAttribute("data-postdeleteid")){const n=await fetch(`${e}/delete_user_post/${o}/`,{method:"POST",headers:{"X-CSRFToken":csrfToken2}}),r=await n.json();if(n.ok&&"true"===r.success){const e=document.querySelector("#len_posts");if(e.innerHTML=+e.innerHTML-1,t.parentElement.parentElement.parentElement.childElementCount<2){let e=document.createElement("p");e.innerHTML="No feeds to fetch",e.classList.add("h-screen","w-full","bg-base-lightbg","dark:bg-base-darkbg","text-[#0d2438]","dark:text-white","text-center");document.querySelector("#postcontent").append(e)}t.parentElement.parentElement.style.display="none",Toastify({text:"Delete succesfull ",duration:3e3,newWindow:!0,gravity:"top",position:"right",stopOnFocus:!0,style:{background:"linear-gradient(to right, #00b09b, #96c93d)"}}).showToast()}else Toastify({text:"An error ocured, please try again later ",duration:3e3,newWindow:!0,close:!0,gravity:"top",position:"right",stopOnFocus:!0,style:{background:"linear-gradient(to right, #00b09b, #96c93d)"}}).showToast()}}))}));let t,n=document.querySelector("#profileunfriendmodal"),o=document.querySelector("#profileclosemodal"),r=document.querySelector("#profileconfirmunfriend"),s=document.querySelector("#unfriendButton");document.querySelector(".dataparent");const i=document.getElementById("profilePictureInput"),a=(document.getElementById("cameraIconLabel"),document.getElementById("cameraIcon"),document.getElementById("imagePreview")),c=document.getElementById("previewImage"),d=document.getElementById("submitButton"),l=document.getElementById("cancelButton");i&&i.addEventListener("change",(function(){const t=i.files[0];if(t){const e=new FileReader;e.onload=function(e){c.src=e.target.result,a.style.display="block",d.style.display="block",l.style.display="block"},e.readAsDataURL(t)}d&&(d.onclick=async n=>{const o=new FormData(document.querySelector("#postform"));o.append("prof_pics",t);(await fetch(`${e}/change_profile_picture`,{method:"POST",body:o,headers:{"X-CSRFToken":"{{ csrf_token }}"}})).ok?(window.location.reload(),Toastify({text:"Successful",duration:3e3,newWindow:!0,gravity:"top",position:"right",stopOnFocus:!0,style:{background:"linear-gradient(to right, #00b09b, #96c93d)"}}).showToast()):Toastify({text:"Something went wrong, try again later",duration:3e3,newWindow:!0,close:!0,gravity:"top",position:"right",stopOnFocus:!0,style:{background:"linear-gradient(to right, #00b09b, #96c93d)"}}).showToast()}),l&&(l.onclick=function(e){i.value="",a.style.display="none",d.style.display="none",l.style.display="none"})})),s&&s.addEventListener("click",(e=>{n.style.display="block",t=e.target.getAttribute("data-content")})),o.addEventListener("click",(()=>n.style.display="none")),r.addEventListener("click",(o=>{f("csrftoken");let r=new XMLHttpRequest;r.open("POST",`${e}/removefriends/${t}/`,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("X-CSRFToken",csrfToken),r.onreadystatechange=function(){r.readyState===XMLHttpRequest.DONE&&200===r.status&&(n.style.display="none")},r.send()}));let p=document.querySelector("#profile_message");$(document).ready((function(){$("#friendrequestcontainer").click((function(){localStorage.getItem("mode");$(".friendrequestparent").empty(),$.ajax({url:`${e}/received_request`,type:"GET",dataType:"json",success:function(t){if(t.received_request.length<1){let e=$("<p>").text("No friend request yet");$(".friendrequestparent").hide(),$("#loadingsequence").hide(),e.appendTo(".friendrequestparent2")}else $(".friendrequestparent2").hide(),$("#loadingsequence").hide(),$(".friendrequestparent").show(),t.received_request.forEach((function(t){let n=$("<div>");n.attr("id","frienddivbg");let o=$("<div>"),r=$("<div>");localStorage.getItem("mode");n.css({width:"fit-content",height:"fit-content",padding:"1rem",display:"grid",gap:"5px","justify-item":"center","align-content":"center","background-color":"white ","border-radius":"10px","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",cursor:"pointer","transform-origin":"center","transition-property":"transform","transition-duration":"300ms"}),n.hover((function(){$(this).css({"box-shadow":"var(--box-shadow-xl)",transform:"scale(1.05)"})}),(function(){$(this).css({"box-shadow":"var(--box-shadow-lg)",transform:"scale(1)"})}));let s=$("<p>").text(t.name);s.css({"font-size":"bold"});let i=$("<p>").text("Accept request");i.css({width:"fit",height:"fit",padding:"6","border-radius":"5px","background-color":"rgb(22 163 74)",color:"rgb(209 213 219)",cursor:"pointer"});let a=$("<p>").text("Decline request");a.css({width:"fit",height:"fit",padding:"6","border-radius":"5px","background-color":"rgb(22 163 74)",color:"rgb(209 213 219)",cursor:"pointer"});let c=$("<p>").text(t.bio),d=$("<img>");d.attr("src",t.pics),d.attr("alt","Profile Picture"),d.attr("width","80"),d.attr("height","80"),d.css("border-radius","50%");let l=$("<div>");o.css({display:"grid",gap:"5px","align-content":"center"}),r.css({display:"flex",gap:"5px","align-item":"center"}),l.css({display:"flex",gap:"5px","padding-right":"1rem","padding-top":"1rem"}),o.append(s),o.append(c),l.append(i),l.append(a),r.append(d),r.append(o),n.append(r),n.append(l),i.click((function(){const n=f("csrftoken");$.ajax({url:`${e}/acceptfriendrequests/${t.relId}/`,type:"POST",dataType:"json",beforeSend:function(e,t){e.setRequestHeader("X-CSRFToken",n)},success:function(e){"ok"==e.success&&(l.empty(),l.text("Accepted"),l.css("text-align","center"))}})})),a.click((function(){const n=f("csrftoken");$.ajax({url:`${e}/declinefriendrequest/${t.sender}/`,type:"POST",dataType:"json",beforeSend:function(e,t){e.setRequestHeader("X-CSRFToken",n)},success:function(e){"ok"===e.success?(l.empty(),l.text("Request declined"),Toastify({text:"Request declined",duration:3e3,newWindow:!0,gravity:"top",position:"right",stopOnFocus:!0,style:{background:"linear-gradient(to right, #00b09b, #96c93d)"}}).showToast()):Toastify({text:"Error! please try again later",duration:3e3,newWindow:!0,close:!0,gravity:"top",position:"right",stopOnFocus:!0,style:{background:"linear-gradient(to right, #00b09b, #96c93d)"}}).showToast()}})})),n.appendTo(".friendrequestparent")}))},error:function(e){}})})),$("#searchButton").click((function(){let t=$("#searchButton").val();$.ajax({url:`${e}/search`,type:"GET",data:{query:t},dataType:"json",success:function(e){},error:function(){}})}))})),p&&($("profileaddfriend").click((function(){let t=p.getAttribute("receiver");$.ajax({url:`${e}/addfriends/${t}/`,type:"POST",dataType:"json",beforeSend:function(e,t){e.setRequestHeader("X-CSRFToken",csrftoken)},success:function(e){"ok"==e.success&&($("profileaddfriend").text="Added")}})})),$("profileblock").click((function(){$.ajax({url:`${e}/blockuser/${friendusername}/`,type:"POST",dataType:"json",beforeSend:function(e,t){e.setRequestHeader("X-CSRFToken",csrftoken)},success:function(e){"ok"==e.success&&($("profileblock").text="Blocked")}})})));document.querySelector("#groups"),document.querySelector("#dropdown-content");const u=document.querySelector("#create-content"),g=document.querySelector("#groupcancelprofile");function f(e){let t=null;if(document.cookie&&""!==document.cookie){const n=document.cookie.split(";");for(let o=0;o<n.length;o++){const r=n[o].trim();if(r.substring(0,e.length+1)===e+"="){t=decodeURIComponent(r.substring(e.length+1));break}}}return t}u&&(u.onclick=function(){creategroupmodal.style.display="block"}),g&&(g.onclick=function(e){e.preventDefault(),creategroupmodal.style.display="none"}),$("#allgroups").on("click",(function(){$(".groupsparent").empty(),$.ajax({method:"GET",url:`${e}/allgroups/json/`,processData:!1,contentType:!1,success:function(t){if(t.length<1){let e=$("<p>").text("No groups found");e.addClass("h-screen w-full bg-base-lightbg dark:bg-base-darkbg text-[#0d2438] dark:text-white text-center"),$(".groupsparent").append(e)}else JSON.parse(t).forEach((t=>{let n=$("<div>"),o=$("<div>"),r=$("<div>");r.css({display:"grid",gap:"5px","justify-items":"center"}),o.css({display:"flex",gap:"5px","justify-content":"center"}),n.css({width:"fit-content",height:"fit-content","padding-top":"1rem","padding-bottom":"1rem","padding-left":"1rem","padding-right":"1rem",display:"grid",gap:"5px","justify-items":"center","align-content":"center","box-shadow":"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)","border-radius":"10px","margin-top":"1rem","margin-bottom":"1rem","margin-left":"1rem","margin-right":"1rem",cursor:"pointer","transform-origin":"center","transition-property":"transform","transition-duration":"300ms"}),n.hover((function(){$(this).css({"box-shadow":"var(--box-shadow-xl)",transform:"scale(1.05)"})}),(function(){$(this).css({"box-shadow":"var(--box-shadow-lg)",transform:"scale(1)"})}));let s=$("<p>").text(t.fields.name),i=$("<p>").text(t.fields.description),a=$("#prof_pics").data("content");s.css({"font-size":"bold"}),i.css({opacity:"0.6","margin-bottom":"1rem"});let c,d=$("<img>");d.attr("src",t.fields.cover_photo),d.attr("alt","cover photo"),d.attr("width","80"),d.attr("height","80"),d.css("border-radius","50%"),a===t.fields.owner?(c=$("<p>").text("Your group"),c.css("color","lime")):(c=$("<p>").text("join group"),c.css({width:"80%",height:"fit",padding:"6","border-radius":"5px","background-color":"rgb(22 163 74)",color:"rgb(209 213 219)",cursor:"pointer","text-align":"center"}),c.click((function(){const n=f("csrftoken");$.ajax({url:`${e}/join-group/${t.pk}`,type:"POST",dataType:"json",beforeSend:function(e,t){e.setRequestHeader("X-CSRFToken",n)},success:function(e){}})}))),r.append(s),r.append(i),o.append(d),o.append(r),n.append(o),n.append(c),n.appendTo(".groupsparent"),n.click((function(){window.location.href=`${e}/group-view/${t.fields.name}`}))}))},error:function(e){console.log(e)}})}));